<!DOCTYPE html><html lang="id"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Keranjang</title>
<script src="https://cdn.tailwindcss.com"></script>
</head><body class="bg-neutral-50">
  {% include 'navbar.html' %}
  <main class="max-w-5xl mx-auto p-4">
    {% include 'flashProtection.html' %}
    <h1 class="text-2xl font-bold mb-4">Keranjang</h1>

    {% if items %}
      <div class="bg-white rounded-xl shadow p-4 overflow-x-auto">
        <table class="w-full text-sm">
          <thead><tr class="text-left border-b">
            <th class="py-2">Produk</th>
            <th class="py-2">Qty</th>
            <th class="py-2">Harga</th>
            <th class="py-2">Subtotal</th>
            <th></th>
          </tr></thead>
          <tbody>
            {% for it in items %}
              <tr class="border-b">
                <td class="py-2">{{ it[2] }}</td>
                <td class="py-2">
                  <form action="{{ url_for('cart_update') }}" method="post" class="flex gap-2 items-center">
                    <input type="hidden" name="item_id" value="{{ it[0] }}"/>
                    <input type="number" name="qty" value="{{ it[3] }}" min="0" class="w-20 border rounded px-2 py-1">
                    <button class="px-3 py-1 bg-neutral-200 rounded hover:bg-neutral-300">Ubah</button>
                  </form>
                </td>
                <td class="py-2">Rp {{ '{:,.0f}'.format(it[4]).replace(',', '.') }}</td>
                <td class="py-2 font-semibold">Rp {{ '{:,.0f}'.format(it[5]).replace(',', '.') }}</td>
                <td class="py-2">
                  <form action="{{ url_for('cart_remove', item_id=it[0]) }}" method="post">
                    <button class="text-red-600 hover:underline">Hapus</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="py-3 text-right font-semibold">Total</td>
              <td class="py-3 font-bold text-red-600">Rp {{ '{:,.0f}'.format(total).replace(',', '.') }}</td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="mt-4 flex justify-end">
        <a href="{{ url_for('checkout') }}" class="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
          Lanjut Checkout
        </a>
      </div>
    {% else %}
      <p class="text-neutral-600">Keranjang kosong.</p>
    {% endif %}
  </main>
</body></html>
